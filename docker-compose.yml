version: '3'

networks:
  default:
    name: portfolio
    driver: bridge

  kua-internal:
    name: kua-internal
    external: true

services: 
  web:
    build: 
      context: .
      dockerfile: Dockerfile
    ports:
      - "3030:3030"
    networks:
      - kua-internal
      - default
    env_file:
      - .env
  
  cloudflared:
    image: cloudflare/cloudflared
    restart: always
    networks:
      - default
      - kua-internal
    command: tunnel --no-autoupdate run --token ${CF_TOKEN}
